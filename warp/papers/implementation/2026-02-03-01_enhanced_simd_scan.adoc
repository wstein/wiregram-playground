= Enhanced SIMD Scan (JSON)

== Summary

This document describes the enhanced SIMD scanning path for JSON that extends the base structural scan with:

- Number boundary detection (digits + dot + exponent markers)
- Word boundary detection (ASCII letters + underscore)
- UTF-8 leading byte detection (non-ASCII)

The enhanced scan is designed to be backward compatible with the existing structural scan and can be enabled via the CLI.

== Implementation

=== New Masks

The SIMD masks now include additional fields:

- `number` — digits and number markers (`0-9`, `.`, `e`, `E`)
- `word` — ASCII letters and underscore
- `utf8_lead` — UTF-8 leading bytes (non-ASCII)

These masks are computed in all backends, with scalar fallback where SIMD-specific logic is not yet implemented.

=== Enhanced SIMD Scan

A new scanner is available at `src/warp/lexer/enhanced_simd_scan.cr`:

- Uses the existing string and UTF-8 validators
- Preserves the existing JSON structural indices
- Adds number and word boundary starts outside string regions
- Detects UTF-8 leading bytes for later-stage semantic processing

== CLI Usage

Enable enhanced SIMD in `dump simd`:

----
warp dump simd --lang json --enhanced path/to/file.json
----

The enhanced scan is also respected in `dump full` when the same flag is used.

== Notes

- The added masks are currently computed using scalar logic inside each backend for portability.
- SIMD-optimized versions can be added per backend without changing the public API.

== Next Steps

- SIMD-optimized number and identifier scanning per backend
- Unicode property tables for more precise letter detection
- Integration into Ruby/Crystal lexers once their SIMD tokenization is expanded
